<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>404 — PROCESOS</title>
  <style>
    :root{--red:#c1121f;--black:#111;--bg:#f6f6f8}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;display:grid;place-items:center}
    .card{background:#fff;border:1px solid #eee;border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.1);padding:28px;max-width:680px;margin:16px}
    h1{margin:0 0 8px;font-size:28px}
    p{margin:6px 0;color:#333}
    .hint{font-size:12px;color:#666}
    a.btn{display:inline-block;margin-top:14px;background:linear-gradient(90deg,#c1121f,#8B0000,#111);color:#fff;text-decoration:none;padding:10px 14px;border-radius:12px}
    code{background:#00000008;border:1px solid #00000012;border-radius:8px;padding:2px 6px}
  </style>
  <script>
    (function(){
      // Redirige a la raíz del proyecto en GitHub Pages
      // Cambia 'PROCESOS' si renombras el repo
      var base = '/PROCESOS/';
      // Evita bucle si ya estamos en la raíz
      if (location.pathname !== base) {
        // Guarda la ruta "rota" por si en el futuro quieres manejar rutas SPA
        sessionStorage.setItem('PROCESOS_LAST_404', location.pathname + location.search + location.hash);
        location.replace(base);
      }
    })();
  </script>
</head>
<body>
  <div class="card">
    <h1>404 — Página no encontrada</h1>
    <p>No hemos encontrado la ruta solicitada.</p>
    <p class="hint">Te redirigimos automáticamente a <code>/PROCESOS/</code>. Si no ocurre, pulsa el botón:</p>
    <p><a class="btn" href="/PROCESOS/">Volver a PROCESOS</a></p>
  <!-- === PROCESOS | Script integrado de nube + corrección de exportación HTML === -->
<script>
(function () {
  var CFG_KEY='FIREBASE_CFG_JSON', WS_KEY='WORKSPACE_ID', LOCK_KEY='CONFIG_LOCKED', BOOT_FLAG='PROCESOS_BOOTSTRAPPED';

  // 1) TU firebaseConfig (SOLO JSON con llaves):
  var FIREBASE_CONFIG={
    "apiKey":"AIzaSyD7k7IbzhXt0PXUP6YCy6ZAQGXQdIKRU_U",
    "authDomain":"proceso-84254.firebaseapp.com",
    "projectId":"proceso-84254",
    "storageBucket":"proceso-84254.firebasestorage.app",
    "messagingSenderId":"433589034329",
    "appId":"1:433589034329:web:ad5d60d662c8beed9e0048",
    "measurementId":"G-DTVJE8D3FG"
  };
  var DEFAULT_WORKSPACE='procesos';

  // 2) Sembrar config en localStorage (y bloquear UI de config si la app lo respeta)
  function seedConfig(){
    var changed=false;
    try{
      var desired=JSON.stringify(FIREBASE_CONFIG);
      if(localStorage.getItem(CFG_KEY)!==desired){ localStorage.setItem(CFG_KEY,desired); changed=true; }
      if(localStorage.getItem(WS_KEY)!==DEFAULT_WORKSPACE){ localStorage.setItem(WS_KEY,DEFAULT_WORKSPACE); changed=true; }
      localStorage.setItem(LOCK_KEY,'1'); // ocultar diálogo de config si el build lo soporta
    }catch(e){ console.warn('[PROCESOS] No se pudo escribir configuración:', e); }
    return changed;
  }

  // 3) Snippet que se inyectará dentro de cualquier HTML exportado
  function buildBootstrapSnippet(){
    var cfg = JSON.stringify(FIREBASE_CONFIG).replace(/</g,'\\u003c');
    var ws  = DEFAULT_WORKSPACE.replace(/</g,'\\u003c');
    return [
      "<!-- === PROCESOS | Bootstrap nube integrado (export) === -->",
      "<script>(function(){",
      "var CFG_KEY='",CFG_KEY,"',WS_KEY='",WS_KEY,"',LOCK_KEY='",LOCK_KEY,"',FLAG='",BOOT_FLAG,"';",
      "var FIREBASE_CONFIG=",cfg,";",
      "var DEFAULT_WORKSPACE='",ws,"';",
      "function seed(){var ch=false;try{var d=JSON.stringify(FIREBASE_CONFIG);",
      "if(localStorage.getItem(CFG_KEY)!==d){localStorage.setItem(CFG_KEY,d);ch=true;}",
      "if(localStorage.getItem(WS_KEY)!==DEFAULT_WORKSPACE){localStorage.setItem(WS_KEY,DEFAULT_WORKSPACE);ch=true;}",
      "localStorage.setItem(LOCK_KEY,'1');}catch(e){console.warn('[PROCESOS] export seed err',e);}return ch}",
      "var changed=seed();",
      "if(changed && !sessionStorage.getItem(FLAG)){sessionStorage.setItem(FLAG,'1');location.reload();}",
      "})();<\/script>",
      "<!-- === /PROCESOS | Fin bootstrap (export) === -->"
    ].join("");
  }

  // 4) Inyección segura de snippet antes de </body> (o al final si no existe)
  function injectIntoHtml(html){
    try{
      var snippet = buildBootstrapSnippet();
      if(typeof html!=='string') html=String(html);
      if(/<\/body>/i.test(html)) return html.replace(/<\/body>/i, snippet + '\n</body>');
      return html + '\n' + snippet;
    }catch(e){ console.warn('[PROCESOS] Falló la inyección en HTML:', e); return html; }
  }

  // 5) Parchear Blob para capturar descargas HTML (botón Archivo de cualquier build)
  try{
    var _Blob = window.Blob;
    var PatchedBlob = function(parts, opts){
      try{
        var type = opts && (opts.type || opts['contentType']) || '';
        if(typeof type==='string' && type.toLowerCase().indexOf('text/html')>-1){
          // Unimos las partes a texto, inyectamos config y construimos de nuevo
          var text = '';
          for(var i=0;i<(parts?parts.length:0);i++){
            var p = parts[i];
            if(p instanceof ArrayBuffer) p = new TextDecoder('utf-8').decode(new Uint8Array(p));
            else if(p instanceof Uint8Array) p = new TextDecoder('utf-8').decode(p);
            text += (typeof p==='string') ? p : (p && p.toString ? p.toString() : '');
          }
          var injected = injectIntoHtml(text);
          return new _Blob([injected], opts);
        }
      }catch(e){ console.warn('[PROCESOS] Blob patch warning:', e); }
      return new _Blob(parts, opts);
    };
    PatchedBlob.prototype = _Blob.prototype;
    window.Blob = PatchedBlob;
    console.log('[PROCESOS] Patch Blob activo: export HTML llevará config integrada.');
  }catch(e){ console.warn('[PROCESOS] No se pudo parchear Blob:', e); }

  // 6) Semilla inicial + recarga única si era necesario
  var changed = seedConfig();
  if(changed && !sessionStorage.getItem(BOOT_FLAG)){
    sessionStorage.setItem(BOOT_FLAG,'1');
    console.log('[PROCESOS] Config integrada aplicada. Recargando para activar Firestore...');
    location.reload();
  }else{
    console.log("[PROCESOS] Nube integrada OK → Firestore(workspace='%s')", DEFAULT_WORKSPACE);
  }
})();
</script>
<!-- === /PROCESOS | Fin script integrado === -->
</div>
</body>
</html>
